# 1
我需要你查看，项目说明.md
我想要搭建一个卷积神经网络示例的教学示例程序，
先编写"项目说明.md"文档里的10个经典模型，数据集采用dataset_documentation_zh.md文档中提到的四个数据集，每个模型编写一个单独的训练脚本，脚本里将模型的定义与训练和评估的循环代码分离开。这样可以使代码结构更清晰。
要求：
1. 单独训练脚本用类封装好，保存在train_scripts文件夹下，并以各自的网络名作为文件名，同时，将训练好的模型保存在models\classic_model路径下，以"网络名+用户自定义输入（如果没有使用训练日期）"作为模型名称。
2. 训练超参数包括：
    optimizer: 优化器类型, 如 'Adam', 'SGD'
    learning_rate: 学习率
    epochs: 训练轮数
    batch_size: 批处理大小
3. 每次训练，用户的输入包括，模型名称（用户自定义输入的部分），数据集名称（展示数据集名称并让用户选择编号），训练超参数。
4. 前后端分离
    前端：
        a. 使用PySide6库搭建前端的GUI，用户输入参数后，点击按钮开始训练；
        b. 训练过程中实时展示loss和accuracy，一个设计两张图，第一张实时展示训练集的loss和accuracy曲线，第二张展示训练集和测试机每个epoch的accuracy曲线。
        c. 训练完成后，用户点击"保存模型"按钮，将模型保存在models\classic_model路径下，点击“保存日志”按钮，将训练日志保存在logs\classic_model路径下的一个文件夹里，文件夹名称采用与模型名称相同的命名规则，保存显示的两张训练图片，以及训练日志。
        d. 上述操作都在“经典模型训练”模块下，另外在预留一个空模块"自定义模型训练"模块，点击后显示“待开发”（左侧边栏点击切换）
    统一后端脚本：
        编写一个统一的后端脚本，调用单独的网络训练脚本实现训练；

总结：你需要编写的脚本：1. 统一后端脚本；2. 前端脚本；3. 各个网络训练脚本若干。

# 2
程序顺利启动了，但是有几个问题：
1. 如图，显示的两张图太狭小了，你可以设置页面滚轮，让图可以显示更大一些；
2. 我希望再增加一张图，这张图显示训练集上的loss和accuracy曲线，但是以batch size为单位显示，而不是以epoch为单位显示。
3. 日志的记录也要有以batch size为单位的记录，而不是仅有以epoch为单位的记录。
4. 日志保存我需要再次强调一下，日志保存在logs\classic_model路径下的一个文件夹里，文件夹名称采用与模型名称相同的命名规则，即"网络名+用户自定义输入（如果没有使用训练日期）"。保存显示的三张训练图片，以及训练日志，输入的训练超参数。
5. 模型不要自动保存，用户点击"保存模型"按钮时才保存。
6. 激活虚拟环境（qwen_coder）的同时启动脚本，不要分开执行，你之前没能成功运行问题在于，你先激活虚拟环境，后再开启一个没有激活虚拟环境的终端运行脚本，导致缺少必要库。

# 3
你解决了大部分问题，但还是有几个问题：
1. 如图，显示的三张图还是太狭小拥挤，你可以设置页面滚轮，让页面可以上下滚动，以便有充足的空间展示图。
2. (base) PS D:\research\qwen_coder> D:/Anaconda/Scripts/activate
(base) PS D:\research\qwen_coder> conda activate qwen_coder
(qwen_coder) PS D:\research\qwen_coder> & C:/Users/huang/.conda/envs/qwen_coder/python.exe d:/research/qwen_coder/main_gui.py
Successfully loaded MNIST dataset with 10 classes
d:\research\qwen_coder\main_gui.py:482: UserWarning: color is redundantly defined by the 'color' keyword argument and the fmt string "b-" (-> color='b'). The keyword argument will take precedence.
  line1 = self.ax3.plot(self.batch_indices, self.batch_losses, 'b-', linewidth=1.5,
d:\research\qwen_coder\main_gui.py:489: UserWarning: color is redundantly defined by the 'color' keyword argument and the fmt string "r-" (-> color='r'). The keyword argument will take precedence.
  line2 = ax3_twin.plot(self.batch_indices, self.batch_accuracies, 'r-', linewidth=1.5,
Epoch [1/10], Loss: 0.2700, Train Accuracy: 92.00%, Test Accuracy: 95.11%, Time: 9.44s
d:\research\qwen_coder\main_gui.py:441: UserWarning: color is redundantly defined by the 'color' keyword argument and the fmt string "b-" (-> color='b'). The keyword argument will take precedence.
  self.ax1.plot(epochs, self.train_losses, 'b-', linewidth=2.5, marker='o',
d:\research\qwen_coder\main_gui.py:452: UserWarning: color is redundantly defined by the 'color' keyword argument and the fmt string "g-" (-> color='g'). The keyword argument will take precedence.
  self.ax2.plot(epochs, self.train_accuracies, 'g-', linewidth=2.5, marker='o',
d:\research\qwen_coder\main_gui.py:455: UserWarning: color is redundantly defined by the 'color' keyword argument and the fmt string "r-" (-> color='r'). The keyword argument will take precedence.
  self.ax2.plot(epochs, self.test_accuracies, 'r-', linewidth=2.5, marker='s',
d:\research\qwen_coder\main_gui.py:468: UserWarning: Tight layout not applied. The bottom and top margins cannot be made large enough to accommodate all Axes decorations.
  self.figure.tight_layout(pad=3.0)
Epoch [2/10], Loss: 0.1318, Train Accuracy: 95.96%, Test Accuracy: 96.27%, Time: 19.06s
d:\research\qwen_coder\main_gui.py:468: UserWarning: Tight layout not applied. tight_layout cannot make Axes height small enough to accommodate all Axes decorations.
  self.figure.tight_layout(pad=3.0)
Epoch [3/10], Loss: 0.1004, Train Accuracy: 96.92%, Test Accuracy: 96.63%, Time: 10.15s
Epoch [4/10], Loss: 0.0833, Train Accuracy: 97.40%, Test Accuracy: 96.62%, Time: 13.20s
Epoch [5/10], Loss: 0.0723, Train Accuracy: 97.68%, Test Accuracy: 97.40%, Time: 37.01s
Epoch [6/10], Loss: 0.0632, Train Accuracy: 97.99%, Test Accuracy: 97.04%, Time: 37.76s
Epoch [7/10], Loss: 0.0564, Train Accuracy: 98.19%, Test Accuracy: 97.59%, Time: 35.15s
Epoch [8/10], Loss: 0.0501, Train Accuracy: 98.38%, Test Accuracy: 97.67%, Time: 28.46s
Epoch [9/10], Loss: 0.0446, Train Accuracy: 98.55%, Test Accuracy: 97.61%, Time: 21.66s
Epoch [10/10], Loss: 0.0414, Train Accuracy: 98.65%, Test Accuracy: 97.39%, Time: 13.99s
终端显示如上，查看是否有问题

# 4
另外有了几个问题：
1. 如图，对于batch level，我发现你似乎是每一个epoch都单独绘制一次loss和accuracy曲线，而不是以batch为单位绘制曲线，即当第一个epoch结束之后，紧跟着第一个epoch的点，开始绘制第二个epoch的loss和accuracy曲线，而不是每一个epoch都从横坐标0开始绘制曲线。
2. 页面的下拉滚动条太细，不好操作，此外颜色与背景色区分不明显难以观察，改进一下。
3. 页面操作不流畅，看看否能优化一下。

# 5
还有几个问题：
1. 如图，还是batch level曲线，这条曲线，特别是train accuracy曲线，前面的部分像是在不断重叠，并且每更新一次，多重低的一次（但是实际上已经训练过，不应该有变化），解决一下；
2. 我构想里有三张图：第一张实时展示训练集的loss和accuracy曲线，第二张展示训练集和测试机每个epoch的accuracy曲线。第三张即你要修改的（问题1.），但我发现第一张也有问题，只显示了loss曲线，没有accuracy曲线，请检查一下，并调整图片名称；
3. 三张图有点过大了，适当缩小一点，到原来尺寸的0.75左右

# 6
继续工作，但是你可能需要修改train_scripts下的所有脚本，另外注意，训练的数据集一共有四个（详见dataset_documentation_zh.md），其中前三个都是灰度图像，第四个是彩色图像，要确保能够根据数据集类型进行选择输入通道数。顺便检查一下其他数据集是否存在使用虚拟数据的情况，如果存在，请修改为实际数据集。


# 7
当前目录下是一个完整的项目，查看整个项目的结构与代码，重新撰写文档：README.md，一版中文，一版英文。

# 8
在README.md文档的项目结构里，不要加入提示词.md，这个文件之后不会被上传到github上，此外，为项目说明文档.md和dataset_documentation_zh.md编写一个英文文档，并添加到项目结构中。